(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-021ad8a1"],{"0d36":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("loading",{attrs:{active:t.isLoading},on:{"update:active":function(e){t.isLoading=e}}}),0==t.cart.total?a("div",{staticClass:"minHeight d-flex justify-content-center align-items-center"},[a("router-link",{staticClass:"btn btnChoco rounded p-5",staticStyle:{"font-size":"22px"},attrs:{to:"/products",title:"回到商品頁面"}},[t._v(" 購物車還空空的喔！ "),a("br"),t._v("趕快去選購吧！ ")])],1):a("div",{staticClass:"minHeight"},[t._m(0),a("div",{staticClass:"container"},[a("div",{staticClass:"row justify-content-center"},[a("div",{staticClass:"col-lg-8 col-md-10 col-12 pt-5"},[t._m(1),a("div",{staticClass:"table-responsive"},[a("table",{staticClass:"table table-hover"},[t._m(2),a("tbody",t._l(t.cartData.carts,(function(e){return a("tr",{key:e.id},[a("td",{staticClass:"text-center align-middle d-none d-sm-table-cell"},[a("a",{attrs:{href:"#",title:"前往商品介紹"},on:{click:function(a){return a.preventDefault(),t.createProduct(e.product.id)}}},[a("img",{staticStyle:{height:"50px"},attrs:{src:e.product.imageUrl,alt:""}})])]),a("td",{staticClass:"align-middle"},[a("a",{staticClass:"text-Choco",attrs:{href:"#",title:"前往商品介紹"},on:{click:function(a){return a.preventDefault(),t.createProduct(e.product.id)}}},[t._v(t._s(e.product.title))]),e.coupon?a("div",{staticClass:"text-success"},[t._v("已套用優惠券")]):t._e()]),a("td",{staticClass:"text-right align-middle"},[t._v(t._s(t._f("currency")(e.product.price)))]),a("td",{staticClass:"text-right align-middle"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.qty,expression:"item.qty"}],on:{change:[function(a){var s=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(e,"qty",a.target.multiple?s:s[0])},function(a){return t.changeQty(e.id,e.product.id,e.qty)}]}},t._l(10,(function(e){return a("option",{key:e,domProps:{value:e}},[t._v(t._s(e))])})),0),t._v(" "+t._s(e.product.unit)+" ")]),a("td",{staticClass:"text-right align-middle"},[t._v(t._s(t._f("currency")(e.qty*e.product.price)))]),a("td",{staticClass:"text-center align-middle"},[a("a",{staticClass:"btn btn-outline-danger",attrs:{href:"#"},on:{click:function(a){return a.preventDefault(),t.delCart(e.id)}}},[a("i",{staticClass:"far fa-trash-alt"})])])])})),0)])]),a("div",{staticClass:"text-right mb-4"},[t.cart.total==t.cart.final_total?a("p",{staticClass:"h5"},[t._v(" 總計： "),a("span",{staticClass:"text-danger"},[t._v(t._s(t._f("currency")(t.cart.total)))]),t._v(" 元 ")]):t._e(),t.cart.total!==t.cart.final_total?a("p",{staticClass:"text-secondary"},[t._v("折扣前總計："+t._s(t._f("currency")(t.cart.total))+" 元")]):t._e(),t.cart.final_total!==t.cart.total?a("p",{staticClass:"h5"},[t._v(" 折扣後總計： "),a("span",{staticClass:"text-danger"},[t._v(t._s(t._f("currency")(t.cart.final_total)))]),t._v(" 元 ")]):t._e()]),a("section",[t._m(3),a("div",{staticClass:"form-row"},[a("div",{staticClass:"col-sm-8 col-12 mb-3"},[a("ValidationProvider",{attrs:{name:"優惠碼",rules:"digits:3"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.errors;return[a("input",{directives:[{name:"model",rawName:"v-model",value:t.couponCode,expression:"couponCode"}],staticClass:"form-control",attrs:{type:"text",placeholder:"請輸入優惠碼"},domProps:{value:t.couponCode},on:{input:function(e){e.target.composing||(t.couponCode=e.target.value)}}}),a("span",{staticClass:"text-danger"},[t._v(t._s(s[0]))])]}}])})],1),a("div",{staticClass:"col-sm-4 col-12 mb-3"},[a("a",{staticClass:"btn checkCoupon d-block",on:{click:function(e){return e.preventDefault(),t.checkCouponCode(e)}}},[t._v("使用優惠碼")])])]),a("router-link",{staticClass:"d-block toProducts rounded mb-3 text-center",attrs:{to:"/coupon"}},[t._v("沒有優惠碼嗎？點此參加活動取得優惠碼！")]),a("router-link",{staticClass:"toProducts mb-3 d-block text-center",attrs:{to:"/products",title:"前往商品頁面"},nativeOn:{click:function(e){return e.preventDefault(),t.getSearchText("All")}}},[a("i",{staticClass:"fas fa-arrow-left"}),t._v(" 繼續選購商品 ")])],1)]),a("div",{staticClass:"col-lg-8 col-md-10 col-12 mb-5"},[t._m(4),a("ValidationObserver",{scopedSlots:t._u([{key:"default",fn:function(e){var s=e.invalid;return[a("form",{staticClass:"form-row justify-content-end",on:{submit:function(e){return e.preventDefault(),t.createCustomOrder(e)}}},[a("div",{staticClass:"form-group col-12"},[a("ValidationProvider",{attrs:{name:"email",rules:"email"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.errors;return[a("label",{attrs:{for:"email"}},[t._v(" Email "),a("span",{staticClass:"text-danger"},[t._v("*必填")])]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.email,expression:"form.user.email"}],staticClass:"form-control",class:{"is-invalid":s[0]||t.isInvalidStyle},attrs:{type:"email",id:"email",name:"email",placeholder:"請輸入 Email"},domProps:{value:t.form.user.email},on:{input:function(e){e.target.composing||t.$set(t.form.user,"email",e.target.value)}}}),a("span",{staticClass:"text-danger"},[t._v(t._s(s[0]))])]}}],null,!0)})],1),a("div",{staticClass:"form-group col-12"},[a("ValidationProvider",{attrs:{name:"姓名",rules:"min:2"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.errors;return[a("label",{attrs:{for:"name"}},[t._v(" 姓名 "),a("span",{staticClass:"text-danger"},[t._v("*必填")])]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.name,expression:"form.user.name"}],staticClass:"form-control",class:{"is-invalid":s[0]||t.isInvalidStyle},attrs:{type:"text",id:"name",name:"name",placeholder:"請輸入姓名"},domProps:{value:t.form.user.name},on:{input:function(e){e.target.composing||t.$set(t.form.user,"name",e.target.value)}}}),a("span",{staticClass:"text-danger"},[t._v(t._s(s[0]))])]}}],null,!0)})],1),a("div",{staticClass:"form-group col-12"},[a("ValidationProvider",{attrs:{name:"電話",rules:"min:9"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.errors;return[a("label",{attrs:{for:"telphone"}},[t._v(" 電話 "),a("span",{staticClass:"text-danger"},[t._v("*必填")])]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.tel,expression:"form.user.tel"}],staticClass:"form-control",class:{"is-invalid":s[0]||t.isInvalidStyle},attrs:{type:"tel",id:"telphone",name:"telphone",placeholder:"請輸入電話"},domProps:{value:t.form.user.tel},on:{input:function(e){e.target.composing||t.$set(t.form.user,"tel",e.target.value)}}}),a("span",{staticClass:"text-danger"},[t._v(t._s(s[0]))])]}}],null,!0)})],1),a("div",{staticClass:"form-group col-12"},[a("ValidationProvider",{attrs:{name:"地址",rules:"min:9"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.errors;return[a("label",{attrs:{for:"address"}},[t._v(" 地址 "),a("span",{staticClass:"text-danger"},[t._v("*必填")])]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.address,expression:"form.user.address"}],staticClass:"form-control",class:{"is-invalid":s[0]||t.isInvalidStyle},attrs:{type:"text",id:"address",name:"address",placeholder:"請輸入地址"},domProps:{value:t.form.user.address},on:{input:function(e){e.target.composing||t.$set(t.form.user,"address",e.target.value)}}}),a("span",{staticClass:"text-danger"},[t._v(t._s(s[0]))])]}}],null,!0)})],1),a("div",{staticClass:"form-group col-12"},[a("label",{attrs:{for:"textarea"}},[t._v("留言")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.message,expression:"form.message"}],staticClass:"form-control",attrs:{id:"textarea",name:"message",rows:"3",placeholder:"有什麼話想告訴我們？"},domProps:{value:t.form.message},on:{input:function(e){e.target.composing||t.$set(t.form,"message",e.target.value)}}})]),a("button",{staticClass:"btn checkCoupon font-weight-bold col-12 col-md-6",attrs:{type:"submit",disabled:s}},[t._v("建立訂單")])])]}}])})],1)])])])],1)},r=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container pt-5"},[a("div",{staticClass:"row justify-content-center"},[a("div",{staticClass:"col-lg-8 col-md-10 col-12"},[a("ul",{staticClass:"form-row ulStyle justify-content-md-around mb-0"},[a("li",{staticClass:"col-md-4 col-12 mb-3"},[a("span",{staticClass:"checkStep d-block text-center active"},[t._v("1.填寫訂購資料")])]),a("li",{staticClass:"col-md-4 col-12 mb-3"},[a("span",{staticClass:"checkStep d-block text-center"},[t._v("2.金流付款")])]),a("li",{staticClass:"col-md-4 col-12 mb-3"},[a("span",{staticClass:"checkStep d-block text-center"},[t._v("3.完成！")])])])])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("h2",{staticClass:"font-weight-bold h4 text-center pb-3 mb-0"},[s("img",{staticStyle:{height:"30px"},attrs:{src:a("b1dd")}}),t._v("訂購資訊 ")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",{staticClass:"text-center d-none d-sm-table-cell"}),a("th",[t._v("品項")]),a("th",{staticClass:"text-right"},[t._v("單價")]),a("th",{staticClass:"text-right"},[t._v("數量")]),a("th",{staticClass:"text-right"},[t._v("總計")]),a("th",{staticClass:"text-center"},[t._v("刪除")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("h2",{staticClass:"font-weight-bold h4 text-center pb-3 mb-0"},[s("img",{staticStyle:{height:"30px"},attrs:{src:a("b1dd")}}),t._v("優惠碼 ")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("h2",{staticClass:"font-weight-bold h4 text-center py-3 mb-0"},[s("img",{staticStyle:{height:"30px"},attrs:{src:a("b1dd")}}),t._v("填寫訂購資料 ")])}],o=(a("99af"),a("b0c0"),{data:function(){return{couponCode:"",isInvalidStyle:!1,form:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{getCart:function(){this.$store.dispatch("getCart")},delCart:function(t){this.$store.dispatch("delCart",t)},checkCouponCode:function(){var t=this,e="".concat("https://vue-course-api.hexschool.io","/api/").concat("text22333","/coupon");t.$store.dispatch("pushLoadingStatu",!0),t.$http.post(e,{data:{code:t.couponCode}}).then((function(e){e.data.success?(t.$store.dispatch("pushLoadingStatu",!1),t.couponCode="",t.$store.dispatch("updateMessage",{message:"優惠碼套用成功",status:"success"}),t.getCart()):(t.$store.dispatch("updateMessage",{message:e.data.message,status:"danger"}),t.couponCode="",t.$store.dispatch("pushLoadingStatu",!1))}))},changeQty:function(t,e,a){var s=this;s.$store.dispatch("pushLoadingStatu",!0);var r="".concat("https://vue-course-api.hexschool.io","/api/").concat("text22333","/cart/").concat(t),o="".concat("https://vue-course-api.hexschool.io","/api/").concat("text22333","/cart"),c={product_id:e,qty:a};s.$http.all([s.$http.delete(r),s.$http.post(o,{data:c})]).then(s.$http.spread((function(t,e){s.getCart(),s.$store.dispatch("pushLoadingStatu",!1),s.$store.dispatch("updateMessage",{message:"購物車變更成功",status:"success"})})))},reCheckCoupon:function(){var t=this,e="".concat("https://vue-course-api.hexschool.io","/api/").concat("text22333","/coupon");t.$http.post(e,{data:{code:"888"}}).then((function(e){e.data.success?(t.couponCode=t.cart.carts.coupon,t.getCart()):t.getCart()}))},createCustomOrder:function(){var t=this,e="".concat("https://vue-course-api.hexschool.io","/api/").concat("text22333","/order"),a=t.form.user;""===a.name||""===a.email||""===a.tel||""===a.address?(t.isInvalidStyle=!0,t.$store.dispatch("updateMessage",{message:"訂購資料必填欄位為空",status:"danger"})):(t.isInvalidStyle=!1,t.$http.post(e,{data:t.form}).then((function(e){e.data.success?t.$router.push("/checkout/".concat(e.data.orderId)):t.$store.dispatch("updateMessage",{message:"訂單建立失敗",status:"danger"}),t.getCart()})))},createProduct:function(t){this.$router.push("/product/".concat(t))},getSearchText:function(t){var e=this;e.$store.dispatch("getSearchText",t)}},computed:{cart:function(){return this.$store.state.cart},isLoading:function(){return this.$store.state.status.isLoading},cartData:function(){var t=JSON.parse(JSON.stringify(this.cart));return t}},created:function(){this.getCart()}}),c=o,n=a("2877"),i=Object(n["a"])(c,s,r,!1,null,null,null);e["default"]=i.exports},b0c0:function(t,e,a){var s=a("83ab"),r=a("9bf2").f,o=Function.prototype,c=o.toString,n=/^\s*function ([^ (]*)/,i="name";!s||i in o||r(o,i,{configurable:!0,get:function(){try{return c.call(this).match(n)[1]}catch(t){return""}}})},b1dd:function(t,e,a){t.exports=a.p+"img/chocolate_icon.3d2a2e41.png"}}]);
//# sourceMappingURL=chunk-021ad8a1.79f3d345.js.map